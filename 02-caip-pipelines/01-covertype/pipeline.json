{"displayName": "covertype-training", "labels": {"tfx_py_version": "3-7", "tfx_runner": "kubeflow_v2", "tfx_version": "0-27-0"}, "pipelineSpec": {"deploymentSpec": {"executors": {"CsvExampleGen_executor": {"container": {"args": ["--executor_class_path", "tfx.components.example_gen.csv_example_gen.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx", "lifecycle": {"preCacheCheck": {"args": ["--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.file_based_example_gen.driver"]}}}}, "Evaluator_executor": {"container": {"args": ["--executor_class_path", "tfx.components.evaluator.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "ExampleValidator_executor": {"container": {"args": ["--executor_class_path", "tfx.components.example_validator.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "Importer.import_user_schema_executor": {"importer": {"artifactUri": {"runtimeParameter": "schema-folder-uri"}, "typeSchema": {"instanceSchema": "title: tfx.Schema\ntype: object\nproperties:\n"}}}, "Pusher_executor": {"container": {"args": ["--executor_class_path", "tfx.components.pusher.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "Resolver.latest_blessed_model_resolver-model-blessing-resolver_executor": {"resolver": {"outputArtifactQueries": {"model_blessing": {"filter": "artifact_type='tfx.ModelBlessing' and state=LIVE and custom_properties['blessed']='1'"}}}}, "Resolver.latest_blessed_model_resolver-model-resolver_executor": {"resolver": {"outputArtifactQueries": {"model": {"filter": "artifact_type='tfx.Model' and state=LIVE and name={$.inputs.artifacts['input'].custom_properties['current_model_id']}"}}}}, "SchemaGen_executor": {"container": {"args": ["--executor_class_path", "tfx.components.schema_gen.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "StatisticsGen_executor": {"container": {"args": ["--executor_class_path", "tfx.components.statistics_gen.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "Trainer_executor": {"container": {"args": ["--executor_class_path", "tfx.extensions.google_cloud_ai_platform.trainer.executor.GenericExecutor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}, "Transform_executor": {"container": {"args": ["--executor_class_path", "tfx.components.transform.executor.Executor", "--json_serialized_invocation_args", "{{$}}", "--runner=DataflowRunner", "--experiments=shuffle_mode=auto", "--project=jk-mlops-dev", "--temp_location=gs://jk-techsummit-bucket/dataflow-temp", "--disk_size_gb=50", "--machine_type=en-standard-8", "--region=us-central1"], "command": ["python", "-m", "tfx.orchestration.kubeflow.v2.container.kubeflow_v2_run_executor"], "image": "gcr.io/jk-mlops-dev/covertype-tfx"}}}}, "pipelineInfo": {"name": "covertype-training"}, "runtimeParameters": {"data-root-uri": {"defaultValue": {"stringValue": "gs://workshop-datasets/covertype/small"}, "type": "STRING"}, "schema-folder-uri": {"defaultValue": {"stringValue": "gs://jk-techsummit-bucket/schema"}, "type": "STRING"}}, "schemaVersion": "1.0.0", "sdkVersion": "0.27.0", "tasks": [{"cachingOptions": {}, "executorLabel": "CsvExampleGen_executor", "inputs": {"parameters": {"input_base": {"runtimeValue": {"runtimeParameter": "data-root-uri"}}, "input_config": {"runtimeValue": {"constantValue": {"stringValue": "{\n  \"splits\": [\n    {\n      \"name\": \"single_split\",\n      \"pattern\": \"*\"\n    }\n  ]\n}"}}}, "output_config": {"runtimeValue": {"constantValue": {"stringValue": "{\n  \"split_config\": {\n    \"splits\": [\n      {\n        \"hash_buckets\": 2,\n        \"name\": \"train\"\n      },\n      {\n        \"hash_buckets\": 1,\n        \"name\": \"eval\"\n      }\n    ]\n  }\n}"}}}, "output_data_format": {"runtimeValue": {"constantValue": {"intValue": "6"}}}}}, "outputs": {"artifacts": {"examples": {"artifactType": {"instanceSchema": "title: tfx.Examples\ntype: object\nproperties:\n  span:\n    type: int\n    description: Span for an artifact.\n  version:\n    type: int\n    description: Version for an artifact.\n  split_names:\n    type: string\n    description: JSON-encoded list of splits for an artifact. Empty string means artifact has no split.\n"}}}}, "taskInfo": {"name": "CsvExampleGen"}}, {"cachingOptions": {}, "executorLabel": "Importer.import_user_schema_executor", "inputs": {"parameters": {"artifact_uri": {"runtimeValue": {"runtimeParameter": "schema-folder-uri"}}, "custom_properties": {"runtimeValue": {"constantValue": {"stringValue": "{}"}}}, "properties": {"runtimeValue": {"constantValue": {"stringValue": "{}"}}}, "reimport": {"runtimeValue": {"constantValue": {"intValue": "0"}}}}}, "outputs": {"artifacts": {"result": {"artifactType": {"instanceSchema": "title: tfx.Schema\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Importer.import_user_schema"}}, {"executorLabel": "Resolver.latest_blessed_model_resolver-model-blessing-resolver_executor", "outputs": {"artifacts": {"model_blessing": {"artifactType": {"instanceSchema": "title: tfx.ModelBlessing\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Resolver.latest_blessed_model_resolver-model-blessing-resolver"}}, {"executorLabel": "Resolver.latest_blessed_model_resolver-model-resolver_executor", "inputs": {"artifacts": {"input": {"outputArtifactKey": "model_blessing", "producerTask": "Resolver.latest_blessed_model_resolver-model-blessing-resolver"}}}, "outputs": {"artifacts": {"model": {"artifactType": {"instanceSchema": "title: tfx.Model\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Resolver.latest_blessed_model_resolver-model-resolver"}}, {"cachingOptions": {}, "dependentTasks": ["CsvExampleGen"], "executorLabel": "StatisticsGen_executor", "inputs": {"artifacts": {"examples": {"outputArtifactKey": "examples", "producerTask": "CsvExampleGen"}}, "parameters": {"exclude_splits": {"runtimeValue": {"constantValue": {"stringValue": "[]"}}}}}, "outputs": {"artifacts": {"statistics": {"artifactType": {"instanceSchema": "title: tfx.ExampleStatistics\ntype: object\nproperties:\n  span:\n    type: int\n    description: Span for an artifact.\n  split_names:\n    type: string\n    description: JSON-encoded list of splits for an artifact. Empty string means artifact has no split.\n"}}}}, "taskInfo": {"name": "StatisticsGen"}}, {"cachingOptions": {}, "dependentTasks": ["CsvExampleGen", "Importer.import_user_schema"], "executorLabel": "Transform_executor", "inputs": {"artifacts": {"examples": {"outputArtifactKey": "examples", "producerTask": "CsvExampleGen"}, "schema": {"outputArtifactKey": "result", "producerTask": "Importer.import_user_schema"}}, "parameters": {"custom_config": {"runtimeValue": {"constantValue": {"stringValue": "null"}}}, "force_tf_compat_v1": {"runtimeValue": {"constantValue": {"intValue": "1"}}}, "module_file": {"runtimeValue": {"constantValue": {"stringValue": "preprocess.py"}}}}}, "outputs": {"artifacts": {"transform_graph": {"artifactType": {"instanceSchema": "title: tfx.TransformGraph\ntype: object\nproperties:\n"}}, "transformed_examples": {"artifactType": {"instanceSchema": "title: tfx.Examples\ntype: object\nproperties:\n  span:\n    type: int\n    description: Span for an artifact.\n  version:\n    type: int\n    description: Version for an artifact.\n  split_names:\n    type: string\n    description: JSON-encoded list of splits for an artifact. Empty string means artifact has no split.\n"}}, "updated_analyzer_cache": {"artifactType": {"instanceSchema": "title: tfx.TransformCache\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Transform"}}, {"cachingOptions": {}, "dependentTasks": ["Importer.import_user_schema", "StatisticsGen"], "executorLabel": "ExampleValidator_executor", "inputs": {"artifacts": {"schema": {"outputArtifactKey": "result", "producerTask": "Importer.import_user_schema"}, "statistics": {"outputArtifactKey": "statistics", "producerTask": "StatisticsGen"}}, "parameters": {"exclude_splits": {"runtimeValue": {"constantValue": {"stringValue": "[]"}}}}}, "outputs": {"artifacts": {"anomalies": {"artifactType": {"instanceSchema": "title: tfx.ExampleAnomalies\ntype: object\nproperties:\n  span:\n    type: int\n    description: Span for an artifact.\n  split_names:\n    type: string\n    description: JSON-encoded list of splits for an artifact. Empty string means artifact has no split.\n"}}}}, "taskInfo": {"name": "ExampleValidator"}}, {"cachingOptions": {}, "dependentTasks": ["StatisticsGen"], "executorLabel": "SchemaGen_executor", "inputs": {"artifacts": {"statistics": {"outputArtifactKey": "statistics", "producerTask": "StatisticsGen"}}, "parameters": {"exclude_splits": {"runtimeValue": {"constantValue": {"stringValue": "[]"}}}, "infer_feature_shape": {"runtimeValue": {"constantValue": {"intValue": "1"}}}}}, "outputs": {"artifacts": {"schema": {"artifactType": {"instanceSchema": "title: tfx.Schema\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "SchemaGen"}}, {"cachingOptions": {}, "dependentTasks": ["Importer.import_user_schema", "Transform"], "executorLabel": "Trainer_executor", "inputs": {"artifacts": {"examples": {"outputArtifactKey": "transformed_examples", "producerTask": "Transform"}, "schema": {"outputArtifactKey": "result", "producerTask": "Importer.import_user_schema"}, "transform_graph": {"outputArtifactKey": "transform_graph", "producerTask": "Transform"}}, "parameters": {"custom_config": {"runtimeValue": {"constantValue": {"stringValue": "{\"ai_platform_training_args\": {\"masterConfig\": {\"imageUri\": \"gcr.io/jk-mlops-dev/covertype-tfx\"}, \"project\": \"jk-mlops-dev\", \"region\": \"us-central1\"}}"}}}, "eval_args": {"runtimeValue": {"constantValue": {"stringValue": "{\"num_steps\": 500}"}}}, "module_file": {"runtimeValue": {"constantValue": {"stringValue": "train.py"}}}, "train_args": {"runtimeValue": {"constantValue": {"stringValue": "{\"num_steps\": 1000}"}}}}}, "outputs": {"artifacts": {"model": {"artifactType": {"instanceSchema": "title: tfx.Model\ntype: object\nproperties:\n"}}, "model_run": {"artifactType": {"instanceSchema": "title: tfx.ModelRun\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Trainer"}}, {"cachingOptions": {}, "dependentTasks": ["CsvExampleGen", "Resolver.latest_blessed_model_resolver-model-resolver", "Trainer"], "executorLabel": "Evaluator_executor", "inputs": {"artifacts": {"baseline_model": {"outputArtifactKey": "model", "producerTask": "Resolver.latest_blessed_model_resolver-model-resolver"}, "examples": {"outputArtifactKey": "examples", "producerTask": "CsvExampleGen"}, "model": {"outputArtifactKey": "model", "producerTask": "Trainer"}}, "parameters": {"eval_config": {"runtimeValue": {"constantValue": {"stringValue": "{\n  \"metrics_specs\": [\n    {\n      \"metrics\": [\n        {\n          \"class_name\": \"SparseCategoricalAccuracy\",\n          \"threshold\": {\n            \"value_threshold\": {\n              \"lower_bound\": 0.5,\n              \"upper_bound\": 0.99\n            }\n          }\n        },\n        {\n          \"class_name\": \"ExampleCount\"\n        }\n      ]\n    }\n  ],\n  \"model_specs\": [\n    {\n      \"label_key\": \"Cover_Type\"\n    }\n  ],\n  \"slicing_specs\": [\n    {},\n    {\n      \"feature_keys\": [\n        \"Wilderness_Area\"\n      ]\n    }\n  ]\n}"}}}, "example_splits": {"runtimeValue": {"constantValue": {"stringValue": "null"}}}}}, "outputs": {"artifacts": {"blessing": {"artifactType": {"instanceSchema": "title: tfx.ModelBlessing\ntype: object\nproperties:\n"}}, "evaluation": {"artifactType": {"instanceSchema": "title: tfx.ModelEvaluation\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Evaluator"}}, {"cachingOptions": {}, "dependentTasks": ["Evaluator", "Trainer"], "executorLabel": "Pusher_executor", "inputs": {"artifacts": {"model": {"outputArtifactKey": "model", "producerTask": "Trainer"}, "model_blessing": {"outputArtifactKey": "blessing", "producerTask": "Evaluator"}}, "parameters": {"custom_config": {"runtimeValue": {"constantValue": {"stringValue": "null"}}}, "push_destination": {"runtimeValue": {"constantValue": {"stringValue": "{\n  \"filesystem\": {\n    \"base_directory\": \"gs://jk-techsummit-bucket/models/covertype\"\n  }\n}"}}}}}, "outputs": {"artifacts": {"pushed_model": {"artifactType": {"instanceSchema": "title: tfx.PushedModel\ntype: object\nproperties:\n"}}}}, "taskInfo": {"name": "Pusher"}}]}, "runtimeConfig": {"gcsOutputDirectory": "gs://jk-techsummit-bucket/runs"}}